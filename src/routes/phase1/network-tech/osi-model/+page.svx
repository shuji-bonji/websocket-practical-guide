---
title: "OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã¨WebSocketã®ä½ç½®"
description: "OSI 7å±¤ãƒ¢ãƒ‡ãƒ«ã‚’ç†è§£ã—ã€WebSocketãŒã©ã®å±¤ã§å‹•ä½œã™ã‚‹ã‹ã‚’æ˜ç¢ºã«æŠŠæ¡ã—ã¾ã™"
duration: "1-1.5æ™‚é–“"
difficulty: "ä¸­ç´š"
phase: 1
lesson: "2.2"
---

<script>
	import LessonLayout from '$lib/components/common/LessonLayout.svelte';
	import Section from '$lib/components/common/Section.svelte';
	import Card from '$lib/components/common/Card.svelte';
	import MermaidLazyLoad from '$lib/components/MermaidLazyLoad.svelte';
</script>

<LessonLayout
	lessonId="phase1-network-tech-osi-model"
	title="OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã¨WebSocketã®ä½ç½®"
	duration="1-1.5æ™‚é–“"
	difficulty="ä¸­ç´š"
	prerequisites={['HTTPåŸºç¤', 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡ã®åŸºæœ¬æ¦‚å¿µ', 'TCP/WebSocketæ¥ç¶šç¢ºç«‹ãƒ—ãƒ­ã‚»ã‚¹']}
	sectionTitle="ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æŠ€è¡“åŸºç¤"
	nextLessonId="phase1-network-tech-http-versions"
	nextLessonTitle="HTTP/1.1ã‹ã‚‰HTTP/3ã¾ã§ã®WebSocketå¯¾å¿œ"
	nextLessonPath="/phase1/network-tech/http-versions"
	learningObjectives={[
		'OSI 7å±¤ãƒ¢ãƒ‡ãƒ«ã§ã®ãƒ‡ãƒ¼ã‚¿é€å—ä¿¡ãƒ—ãƒ­ã‚»ã‚¹ã®å®Œå…¨ç†è§£',
		'å„å±¤ã§ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ã€ãƒ‘ã‚±ãƒƒãƒˆã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰ã®æŠŠæ¡',
		'WebSocketãŒã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ã§å‹•ä½œã™ã‚‹ã“ã¨ã®æŠ€è¡“çš„æ„å‘³ã®ç†è§£',
		'å®Ÿéš›ã®WebSocketé€šä¿¡ã«ãŠã‘ã‚‹å„å±¤ã®å½¹å‰²ã¨è²¬ä»»ã®æ˜ç¢ºåŒ–'
	]}
>

<Section title="å­¦ç¿’å†…å®¹" icon="ğŸ“š">
	<Card title="ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§å­¦ã¶ã“ã¨" icon="ğŸ“‹" accentColor="blue">
		<p><strong>OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«</strong>ï¼ˆOpen Systems Interconnection Reference Modelï¼‰ã¯ã€å›½éš›æ¨™æº–åŒ–æ©Ÿæ§‹ï¼ˆISOï¼‰ãŒç­–å®šã—ãŸãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡ã®7å±¤æ§‹é€ ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚WebSocketé€šä¿¡ãŒã“ã®æ¨™æº–çš„ãªæ çµ„ã¿ã§ã©ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ã‹ã‚’è©³ã—ãå­¦ç¿’ã—ã¾ã™ã€‚</p>
		<ul>
			<li><strong>OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«7å±¤</strong>ã§ã®WebSocketé€šä¿¡ã®ä½ç½®ã¥ã‘</li>
			<li><strong>é€ä¿¡å´ã¨å—ä¿¡å´</strong>ã§ã®ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ—ãƒ­ã‚»ã‚¹</li>
			<li><strong>å„å±¤ã§ã®ãƒ‡ãƒ¼ã‚¿å‘¼ã³å</strong>ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ã€ãƒ‘ã‚±ãƒƒãƒˆã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰</li>
			<li><strong>WebSocketã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤å‹•ä½œ</strong>ã®æŠ€è¡“çš„æ„å‘³</li>
			<li><strong>å®Ÿè·µçš„ãªãƒ‡ãƒãƒƒã‚°</strong>ã§ã®å±¤åˆ¥ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</li>
		</ul>
	</Card>
</Section>

<Section title="OSI 7å±¤ãƒ¢ãƒ‡ãƒ«ã¨ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼" icon="ğŸ—ï¸">

<Card title="é€ä¿¡å´ï¼šã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¸" icon="ğŸ“¤" accentColor="green">

é€ä¿¡æ™‚ã¯**ä¸Šä½å±¤ã‹ã‚‰ä¸‹ä½å±¤**ã¸ãƒ‡ãƒ¼ã‚¿ãŒæµã‚Œã€å„å±¤ã§ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚

</Card>

<div class="bg-green-50 dark:bg-green-900/20 p-6 rounded-lg border-l-4 border-green-400 dark:border-green-600">
<h4 class="text-lg font-semibold text-green-900 dark:text-green-200 mb-4">ğŸ“¤ OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ï¼šé€ä¿¡å´ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼</h4>

```
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆWebSocketãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 7: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤              â”‚ â† WebSocketãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
â”‚ WebSocketãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 6: ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤            â”‚ â† TLSæš—å·åŒ– (wss://)
â”‚ TLSæš—å·åŒ– (wss://)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 5: ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤                   â”‚ â† WebSocketæ¥ç¶šç®¡ç† â­
â”‚ WebSocketæ¥ç¶šç®¡ç†                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤               â”‚ â† TCPã‚»ã‚°ãƒ¡ãƒ³ãƒˆä½œæˆ
â”‚ TCPã‚»ã‚°ãƒ¡ãƒ³ãƒˆä½œæˆ                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤                 â”‚ â† IPãƒ‘ã‚±ãƒƒãƒˆä½œæˆ
â”‚ IPãƒ‘ã‚±ãƒƒãƒˆä½œæˆ                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: ãƒ‡ãƒ¼ã‚¿ãƒªãƒ³ã‚¯å±¤                 â”‚ â† Ethernetãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
â”‚ Ethernetãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: ç‰©ç†å±¤                         â”‚ â† é›»æ°—ä¿¡å·ã¨ã—ã¦é€ä¿¡
â”‚ é›»æ°—ä¿¡å·ã¨ã—ã¦é€ä¿¡                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
        ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€ä¿¡
```

**â­ WebSocketã¯OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ï¼ˆLayer 5ï¼‰ã§å‹•ä½œ**

</div>

<Card title="é€ä¿¡å´ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã®è©³ç´°" icon="ğŸ“¤" accentColor="green">

#### å„å±¤ã§ã®ãƒ‡ãƒ¼ã‚¿å¤‰æ›

- **Layer 7**: WebSocketãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ **WebSocketãƒ•ãƒ¬ãƒ¼ãƒ **
- **Layer 6**: æš—å·åŒ–å‡¦ç†ï¼ˆwss://ã®å ´åˆï¼‰
- **Layer 5**: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†æƒ…å ±ã®ä»˜åŠ 
- **Layer 4**: TCPãƒ˜ãƒƒãƒ€ãƒ¼è¿½åŠ  â†’ **TCPã‚»ã‚°ãƒ¡ãƒ³ãƒˆ**
- **Layer 3**: IPãƒ˜ãƒƒãƒ€ãƒ¼è¿½åŠ  â†’ **IPãƒ‘ã‚±ãƒƒãƒˆ**
- **Layer 2**: Ethernetãƒ˜ãƒƒãƒ€ãƒ¼è¿½åŠ  â†’ **Ethernetãƒ•ãƒ¬ãƒ¼ãƒ **
- **Layer 1**: ç‰©ç†çš„ãªä¿¡å·ã«å¤‰æ›

</Card>

<Card title="å—ä¿¡å´ï¼šãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‹ã‚‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¸" icon="ğŸ“¥" accentColor="blue">

å—ä¿¡æ™‚ã¯**ä¸‹ä½å±¤ã‹ã‚‰ä¸Šä½å±¤**ã¸ãƒ‡ãƒ¼ã‚¿ãŒæµã‚Œã€å„å±¤ã§ãƒ˜ãƒƒãƒ€ãƒ¼ãŒé™¤å»ã•ã‚Œã¾ã™ã€‚

</Card>

<div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border-l-4 border-blue-400 dark:border-blue-600">
<h4 class="text-lg font-semibold text-blue-900 dark:text-blue-200 mb-4">ğŸ“¥ OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ï¼šå—ä¿¡å´ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼</h4>

```
      ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å—ä¿¡
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: ç‰©ç†å±¤                         â”‚ â† é›»æ°—ä¿¡å·å—ä¿¡
â”‚ é›»æ°—ä¿¡å·å—ä¿¡                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: ãƒ‡ãƒ¼ã‚¿ãƒªãƒ³ã‚¯å±¤                 â”‚ â† Ethernetãƒ•ãƒ¬ãƒ¼ãƒ è§£æ
â”‚ Ethernetãƒ•ãƒ¬ãƒ¼ãƒ è§£æ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤                 â”‚ â† IPãƒ‘ã‚±ãƒƒãƒˆå‡¦ç†
â”‚ IPãƒ‘ã‚±ãƒƒãƒˆå‡¦ç†                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤               â”‚ â† TCPã‚»ã‚°ãƒ¡ãƒ³ãƒˆå‡¦ç†
â”‚ TCPã‚»ã‚°ãƒ¡ãƒ³ãƒˆå‡¦ç†                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 5: ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤                   â”‚ â† WebSocketæ¥ç¶šç¶­æŒ â­
â”‚ WebSocketæ¥ç¶šç¶­æŒ                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 6: ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤            â”‚ â† TLSå¾©å·åŒ– (wss://)
â”‚ TLSå¾©å·åŒ– (wss://)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 7: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤              â”‚ â† WebSocketãƒ•ãƒ¬ãƒ¼ãƒ å‡¦ç†
â”‚ WebSocketãƒ•ãƒ¬ãƒ¼ãƒ å‡¦ç†                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡ï¼‰
```

**â­ OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã§ã®WebSocketå‡¦ç†ï¼šã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ãŒä¸­æ ¸**

</div>

<Card title="å—ä¿¡å´ãƒ‡ãƒ¼ã‚¿å¾©å…ƒã®è©³ç´°" icon="ğŸ“¥" accentColor="blue">

#### å„å±¤ã§ã®ãƒ‡ãƒ¼ã‚¿å¾©å…ƒ

- **Layer 1**: ç‰©ç†ä¿¡å·å—ä¿¡
- **Layer 2**: **Ethernetãƒ•ãƒ¬ãƒ¼ãƒ ** â†’ IPãƒ‘ã‚±ãƒƒãƒˆæŠ½å‡º
- **Layer 3**: **IPãƒ‘ã‚±ãƒƒãƒˆ** â†’ TCPã‚»ã‚°ãƒ¡ãƒ³ãƒˆæŠ½å‡º
- **Layer 4**: **TCPã‚»ã‚°ãƒ¡ãƒ³ãƒˆ** â†’ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
- **Layer 5**: WebSocketæ¥ç¶šçŠ¶æ…‹ç¢ºèª
- **Layer 6**: TLSå¾©å·åŒ–ï¼ˆwss://ã®å ´åˆï¼‰
- **Layer 7**: **WebSocketãƒ•ãƒ¬ãƒ¼ãƒ ** â†’ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æŠ½å‡º

</Card>

</Section>

<Section title="WebSocketã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤å‹•ä½œ" icon="ğŸ¯">

<Card title="Layer 5ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ï¼‰ã§ã®é‡è¦ãªæ©Ÿèƒ½" icon="ğŸŒ" accentColor="yellow">

WebSocketãŒ**ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ã§å‹•ä½œã™ã‚‹**ã“ã¨ã«ã¯æ·±ã„æŠ€è¡“çš„æ„å‘³ãŒã‚ã‚Šã¾ã™ã€‚

### ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ã®æ ¸å¿ƒæ©Ÿèƒ½

**1. æŒç¶šçš„æ¥ç¶šã®ç®¡ç†**
```javascript
// WebSocketã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®å®Ÿè£…ä¾‹
class WebSocketSession {
  constructor(url) {
    this.state = 'CONNECTING';
    this.socket = new WebSocket(url);
    
    // ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ã§ã®çŠ¶æ…‹ç®¡ç†
    this.socket.onopen = () => {
      this.state = 'OPEN';
      this.startHeartbeat(); // ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶­æŒæ©Ÿèƒ½
    };
    
    this.socket.onclose = () => {
      this.state = 'CLOSED';
      this.stopHeartbeat();
    };
  }
  
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ç‹¬è‡ªã®æ©Ÿèƒ½
  startHeartbeat() {
    this.heartbeatInterval = setInterval(() => {
      if (this.state === 'OPEN') {
        this.socket.send(JSON.stringify({ type: 'ping' }));
      }
    }, 30000);
  }
}
```

**2. åŠäºŒé‡ãƒ»å…¨äºŒé‡é€šä¿¡ã®åˆ¶å¾¡**
```javascript
// ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ã§ã®é€šä¿¡åˆ¶å¾¡
class WebSocketCommunicationControl {
  constructor(socket) {
    this.socket = socket;
    this.sendQueue = [];
    this.isReceiving = false;
    this.isSending = false;
  }
  
  // å…¨äºŒé‡é€šä¿¡ã®å®Ÿè£…
  async sendMessage(message) {
    this.isSending = true;
    try {
      this.socket.send(JSON.stringify(message));
      // åŒæ™‚ã«å—ä¿¡ã‚‚å¯èƒ½ï¼ˆå…¨äºŒé‡ï¼‰
    } finally {
      this.isSending = false;
    }
  }
  
  handleReceive(event) {
    this.isReceiving = true;
    const message = JSON.parse(event.data);
    // é€ä¿¡ä¸­ã§ã‚‚å—ä¿¡å‡¦ç†ãŒå¯èƒ½ï¼ˆå…¨äºŒé‡ï¼‰
    this.processMessage(message);
    this.isReceiving = false;
  }
}
```

**3. ã‚»ãƒƒã‚·ãƒ§ãƒ³åŒæœŸã¨ã‚¨ãƒ©ãƒ¼å›å¾©**
```javascript
// ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ã§ã®ã‚¨ãƒ©ãƒ¼å›å¾©
class WebSocketSessionRecovery {
  constructor(url) {
    this.url = url;
    this.lastMessageId = 0;
    this.unacknowledgedMessages = new Map();
    this.connect();
  }
  
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ã§ã®è‡ªå‹•å†æ¥ç¶š
  async reconnect() {
    console.log('Session layer: Attempting reconnection');
    
    // ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®ä¿å­˜
    const sessionState = {
      lastMessageId: this.lastMessageId,
      pendingMessages: Array.from(this.unacknowledgedMessages.values())
    };
    
    this.connect();
    
    // ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®å¾©å…ƒ
    await this.restoreSession(sessionState);
  }
}
```

</Card>

<Card title="ä»–ã®å±¤ã¨ã®é€£æºãƒ‘ã‚¿ãƒ¼ãƒ³" icon="ğŸ”„" accentColor="indigo">

### Layer 4ï¼ˆãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ï¼‰ã¨ã®é–¢ä¿‚

**TCPæ¥ç¶šã®ä¸Šä½ã«WebSocketã‚»ãƒƒã‚·ãƒ§ãƒ³**

```javascript
// TCP (Layer 4) ã®åŸºç›¤ã®ä¸Šã§WebSocket (Layer 5) ãŒå‹•ä½œ
const tcpConnection = {
  // Layer 4: TCPæ©Ÿèƒ½
  sequenceNumber: 1000,
  acknowledgmentNumber: 2000,
  windowSize: 8192,
  
  // TCPã¯ä¿¡é ¼æ€§ã®ã‚ã‚‹ãƒã‚¤ãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’æä¾›
  send: (data) => { /* TCP segmentation & transmission */ },
  receive: () => { /* TCP reassembly & ordering */ }
};

const websocketSession = {
  // Layer 5: WebSocketã‚»ãƒƒã‚·ãƒ§ãƒ³æ©Ÿèƒ½
  connectionState: 'OPEN',
  
  // TCPã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ä¸Šã§WebSocketãƒ•ãƒ¬ãƒ¼ãƒŸãƒ³ã‚°
  sendFrame: (message) => {
    const frame = this.createWebSocketFrame(message);
    tcpConnection.send(frame); // TCPå±¤ã«å§”è­²
  },
  
  receiveFrame: () => {
    const rawData = tcpConnection.receive(); // TCPå±¤ã‹ã‚‰å—ä¿¡
    return this.parseWebSocketFrame(rawData);
  }
};
```

### Layer 6ï¼ˆãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‰ã¨ã®é–¢ä¿‚

**TLSæš—å·åŒ–ã®ä½ç½®ã¥ã‘**

```javascript
// wss:// ã§ã®å±¤é–“é€£æº
const websocketWithTLS = {
  // Layer 6: TLSæš—å·åŒ–
  tlsSession: {
    encrypt: (data) => { /* TLS encryption */ },
    decrypt: (data) => { /* TLS decryption */ }
  },
  
  // Layer 5: WebSocketã‚»ãƒƒã‚·ãƒ§ãƒ³
  websocketSession: {
    sendMessage: (message) => {
      const frame = this.createFrame(message);
      const encryptedFrame = this.tlsSession.encrypt(frame);
      this.tcpConnection.send(encryptedFrame);
    }
  }
};
```

</Card>

</Section>

<Section title="å„å±¤ã§ã®ãƒ‡ãƒ¼ã‚¿ã®å‘¼ã³åã¨æ§‹é€ " icon="ğŸ“¦">

<Card title="OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã®Layeråˆ¥ãƒ‡ãƒ¼ã‚¿å˜ä½" icon="ğŸ·ï¸" accentColor="purple">

**OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«**ã§ã¯ã€å„å±¤ã§æ‰±ã†ãƒ‡ãƒ¼ã‚¿ã«å›ºæœ‰ã®åå‰ãŒä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚WebSocketé€šä¿¡ã‚’ç†è§£ã™ã‚‹ã«ã¯ã€ã“ã®æ¨™æº–åŒ–ã•ã‚ŒãŸç”¨èªä½“ç³»ã®ç†è§£ãŒé‡è¦ã§ã™ã€‚

### OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«ã§ã®ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ—ãƒ­ã‚»ã‚¹

**OSIå‚ç…§ãƒ¢ãƒ‡ãƒ«**ã¯ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€šä¿¡ã‚’7ã¤ã®éšå±¤ã«åˆ†ã‘ã¦æ¨™æº–åŒ–ã—ãŸãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚å„å±¤ã«ã¯å›ºæœ‰ã®å½¹å‰²ã¨ã€æ‰±ã†ãƒ‡ãƒ¼ã‚¿å˜ä½ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚WebSocketã¯ã“ã®ãƒ¢ãƒ‡ãƒ«ã«æº–æ‹ ã—ã¦å‹•ä½œã™ã‚‹ãŸã‚ã€å„å±¤ã§ã®ãƒ‡ãƒ¼ã‚¿å½¢å¼ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚

<div class="overflow-x-auto">
<table class="min-w-full bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600">
<thead class="bg-gray-50 dark:bg-gray-700">
<tr>
<th class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-left text-gray-900 dark:text-gray-100">Layer</th>
<th class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-left text-gray-900 dark:text-gray-100">ãƒ‡ãƒ¼ã‚¿å˜ä½</th>
<th class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-left text-gray-900 dark:text-gray-100">ä¸»è¦ãƒ˜ãƒƒãƒ€ãƒ¼</th>
<th class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-left text-gray-900 dark:text-gray-100">WebSocketã§ã®å½¹å‰²</th>
</tr>
</thead>
<tbody>
<tr class="bg-red-50 dark:bg-red-900/20">
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 font-semibold text-gray-900 dark:text-gray-100">Layer 7</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ãƒ‡ãƒ¼ã‚¿ / ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">WebSocketãƒ•ãƒ¬ãƒ¼ãƒ ãƒ˜ãƒƒãƒ€ãƒ¼</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡¦ç†</td>
</tr>
<tr class="bg-orange-50 dark:bg-orange-900/20">
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 font-semibold text-gray-900 dark:text-gray-100">Layer 6</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">æš—å·åŒ–ãƒ‡ãƒ¼ã‚¿</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">TLS Record Header</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">wss://ã§ã®æš—å·åŒ–ãƒ»å¾©å·åŒ–</td>
</tr>
<tr class="bg-yellow-50 dark:bg-yellow-900/20">
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 font-semibold text-gray-900 dark:text-gray-100">Layer 5</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ¶å¾¡æƒ…å ±</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"><strong>WebSocketã®ä¸»è¦å‹•ä½œå±¤</strong></td>
</tr>
<tr class="bg-green-50 dark:bg-green-900/20">
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 font-semibold text-gray-900 dark:text-gray-100">Layer 4</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"><strong>ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ</strong></td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">TCPãƒ˜ãƒƒãƒ€ãƒ¼ (20bytes)</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ä¿¡é ¼æ€§ã®ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿è»¢é€</td>
</tr>
<tr class="bg-blue-50 dark:bg-blue-900/20">
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 font-semibold text-gray-900 dark:text-gray-100">Layer 3</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"><strong>ãƒ‘ã‚±ãƒƒãƒˆ</strong></td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">IPãƒ˜ãƒƒãƒ€ãƒ¼ (20bytes)</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹è§£æ±º</td>
</tr>
<tr class="bg-purple-50 dark:bg-purple-900/20">
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 font-semibold text-gray-900 dark:text-gray-100">Layer 2</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300"><strong>ãƒ•ãƒ¬ãƒ¼ãƒ </strong></td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">Ethernetãƒ˜ãƒƒãƒ€ãƒ¼ (14bytes)</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ç‰©ç†çš„ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®è»¢é€</td>
</tr>
<tr class="bg-gray-50 dark:bg-gray-700">
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 font-semibold text-gray-900 dark:text-gray-100">Layer 1</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ãƒ“ãƒƒãƒˆ / ä¿¡å·</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ãªã—</td>
<td class="px-4 py-2 border-b border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300">ç‰©ç†çš„ä¿¡å·ã¨ã—ã¦ä¼é€</td>
</tr>
</tbody>
</table>
</div>

### WebSocketãƒ•ãƒ¬ãƒ¼ãƒ ã®æ§‹é€ ï¼ˆLayer 7ï¼‰

```
WebSocketãƒ•ãƒ¬ãƒ¼ãƒ æ§‹é€ :
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-------+-+-------------+-------------------------------+
|F|R|R|R| opcode|M| Payload len |    Extended payload length    |
|I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |
|N|V|V|V|       |S|             |   (if payload len==126/127)   |
| |1|2|3|       |K|             |                               |
+-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +
|     Extended payload length continued, if payload len == 127  |
+ - - - - - - - - - - - - - - - +-------------------------------+
|                               |Masking-key, if MASK set to 1  |
+-------------------------------+-------------------------------+
| Masking-key (continued)       |          Payload Data         |
+-------------------------------- - - - - - - - - - - - - - - - +
:                     Payload Data continued ...                :
+ - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +
|                     Payload Data continued ...                |
+---------------------------------------------------------------+
```

</Card>

<Card title="å®Ÿéš›ã®ãƒ‘ã‚±ãƒƒãƒˆã‚­ãƒ£ãƒ—ãƒãƒ£ä¾‹" icon="ğŸ”" accentColor="red">

### Wiresharkã§ã®å®Ÿéš›ã®WebSocketé€šä¿¡

**Layer 2: Ethernetãƒ•ãƒ¬ãƒ¼ãƒ **
```
Ethernet II, Src: 00:11:22:33:44:55, Dst: aa:bb:cc:dd:ee:ff
    Destination: aa:bb:cc:dd:ee:ff
    Source: 00:11:22:33:44:55
    Type: IPv4 (0x0800)
```

**Layer 3: IPãƒ‘ã‚±ãƒƒãƒˆ**
```
Internet Protocol Version 4
    Version: 4
    Header Length: 20 bytes
    Total Length: 96
    Protocol: TCP (6)
    Source: 192.168.1.100
    Destination: 203.0.113.10
```

**Layer 4: TCPã‚»ã‚°ãƒ¡ãƒ³ãƒˆ**
```
Transmission Control Protocol
    Source Port: 52341
    Destination Port: 443 (https)
    Sequence Number: 1
    Acknowledgment Number: 1
    Flags: PSH, ACK
    [This is a segment of a reassembled PDU]
```

**Layer 5-7: WebSocketãƒ‡ãƒ¼ã‚¿**
```
WebSocket
    1... .... = Fin: True
    .000 .... = Reserved: 0x0
    .... 0001 = Opcode: Text (1)
    1... .... = Mask: True
    .011 1110 = Payload length: 62
    Masking-Key: 0x12345678
    Payload: {"type":"message","content":"Hello WebSocket!"}
```

</Card>

</Section>

<Section title="å®Ÿè·µçš„ãªWebSocketé–‹ç™ºã§ã®æ´»ç”¨" icon="ğŸ› ï¸">

<Card title="å±¤åˆ¥ãƒ‡ãƒãƒƒã‚°ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ" icon="ğŸ›" accentColor="orange">

### å•é¡Œç™ºç”Ÿæ™‚ã®ä½“ç³»çš„èª¿æŸ»æ–¹æ³•

**1. Layer 7ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‰ã®å•é¡Œ**
```javascript
// WebSocketãƒ•ãƒ¬ãƒ¼ãƒ è§£æ
const debugWebSocketFrame = (event) => {
  console.log('Layer 7 Debug:');
  console.log('- Frame type:', event.type);
  console.log('- Payload size:', event.data.length);
  console.log('- Content:', event.data);
  
  // ãƒ•ãƒ¬ãƒ¼ãƒ æ§‹é€ ã®æ¤œè¨¼
  if (typeof event.data === 'string') {
    try {
      const parsed = JSON.parse(event.data);
      console.log('- Valid JSON:', parsed);
    } catch (e) {
      console.log('- Invalid JSON format');
    }
  }
};
```

**2. Layer 5ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ï¼‰ã®å•é¡Œ**
```javascript
// WebSocketã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ç›£è¦–
const debugWebSocketSession = (ws) => {
  console.log('Layer 5 Debug:');
  console.log('- Ready State:', ws.readyState);
  console.log('- URL:', ws.url);
  console.log('- Protocol:', ws.protocol);
  console.log('- Extensions:', ws.extensions);
  
  // æ¥ç¶šçŠ¶æ…‹ã®è©³ç´°åˆ†æ
  const states = {
    0: 'CONNECTING',
    1: 'OPEN', 
    2: 'CLOSING',
    3: 'CLOSED'
  };
  console.log('- State Name:', states[ws.readyState]);
};
```

**3. Layer 4ï¼ˆãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ï¼‰ã®å•é¡Œ**
```javascript
// TCPæ¥ç¶šå•é¡Œã®èª¿æŸ»ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ä½¿ç”¨ï¼‰
const analyzeNetworkLayer = () => {
  console.log('Layer 4 Debug (Check in Network tab):');
  console.log('- TCP connection establishment time');
  console.log('- TCP congestion window size');
  console.log('- Retransmission count');
  console.log('- Connection timeout values');
};
```

**4. ç·åˆçš„ãªè¨ºæ–­ãƒ„ãƒ¼ãƒ«**
```javascript
class WebSocketLayerDiagnostics {
  constructor(url) {
    this.url = url;
    this.diagnostics = {
      layer7: { errors: [], warnings: [] },
      layer5: { errors: [], warnings: [] },
      layer4: { errors: [], warnings: [] }
    };
  }
  
  diagnose() {
    const ws = new WebSocket(this.url);
    
    // Layer 5 è¨ºæ–­
    ws.onopen = () => {
      this.diagnostics.layer5.warnings.push('Connection established');
      this.performLayer7Tests(ws);
    };
    
    ws.onerror = (error) => {
      this.diagnostics.layer5.errors.push(`Connection error: ${error}`);
      this.analyzeConnectionFailure();
    };
    
    ws.onclose = (event) => {
      this.diagnostics.layer5.warnings.push(
        `Connection closed: Code ${event.code}, Reason: ${event.reason}`
      );
    };
    
    return this.diagnostics;
  }
  
  performLayer7Tests(ws) {
    // JSONå½¢å¼ãƒ†ã‚¹ãƒˆ
    try {
      ws.send('{"test": "json"}');
      this.diagnostics.layer7.warnings.push('JSON format test passed');
    } catch (e) {
      this.diagnostics.layer7.errors.push('JSON format test failed');
    }
    
    // ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆ
    try {
      ws.send(new ArrayBuffer(8));
      this.diagnostics.layer7.warnings.push('Binary data test passed');
    } catch (e) {
      this.diagnostics.layer7.errors.push('Binary data test failed');
    }
  }
}
```

</Card>

<Card title="æ€§èƒ½æœ€é©åŒ–ã«ãŠã‘ã‚‹å±¤ã®ç†è§£" icon="âš¡" accentColor="green">

### å„å±¤ã§ã®æœ€é©åŒ–æˆ¦ç•¥

**Layer 5ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤ï¼‰æœ€é©åŒ–**
```javascript
// åŠ¹ç‡çš„ãªã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
class OptimizedWebSocketSession {
  constructor(url) {
    this.url = url;
    this.messageQueue = [];
    this.batchSize = 10;
    this.batchTimeout = 100; // ms
    
    this.connect();
    this.startBatchProcessor();
  }
  
  // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒãƒƒãƒãƒ³ã‚°ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤æœ€é©åŒ–ï¼‰
  sendMessage(message) {
    this.messageQueue.push(message);
    
    if (this.messageQueue.length >= this.batchSize) {
      this.processBatch();
    }
  }
  
  processBatch() {
    if (this.messageQueue.length === 0) return;
    
    const batch = {
      type: 'batch',
      messages: this.messageQueue.splice(0, this.batchSize),
      timestamp: Date.now()
    };
    
    this.ws.send(JSON.stringify(batch));
  }
  
  startBatchProcessor() {
    setInterval(() => {
      if (this.messageQueue.length > 0) {
        this.processBatch();
      }
    }, this.batchTimeout);
  }
}
```

**Layer 4ï¼ˆãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå±¤ï¼‰é…æ…®**
```javascript
// TCPç‰¹æ€§ã‚’è€ƒæ…®ã—ãŸå®Ÿè£…
class TCPAwareWebSocket {
  constructor(url) {
    this.url = url;
    this.socket = new WebSocket(url);
    this.setupTCPOptimizations();
  }
  
  setupTCPOptimizations() {
    // TCP Nagle Algorithmå¯¾ç­–
    this.sendBuffer = [];
    this.flushInterval = setInterval(() => {
      this.flushBuffer();
    }, 10); // 10msæ¯ã«ãƒ•ãƒ©ãƒƒã‚·ãƒ¥
  }
  
  send(data) {
    // å°ã•ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°
    if (data.length < 1460) { // TCP MSSä»¥ä¸‹
      this.sendBuffer.push(data);
    } else {
      this.flushBuffer();
      this.socket.send(data);
    }
  }
  
  flushBuffer() {
    if (this.sendBuffer.length > 0) {
      const combinedData = this.sendBuffer.join('');
      this.socket.send(combinedData);
      this.sendBuffer = [];
    }
  }
}
```

</Card>

</Section>

<Section title="å­¦ç¿’æˆæœã®ç¢ºèª" icon="ğŸ“Š">

<Card title="ç¿’å¾—ã—ãŸçŸ¥è­˜ã®ç·æ‹¬" icon="ğŸ¯" accentColor="indigo">

<div class="grid md:grid-cols-2 gap-6">

<div>
<h4 class="font-semibold text-indigo-800 mb-3">ğŸ”¬ æŠ€è¡“çš„æ·±å±¤ç†è§£</h4>
<ul class="space-y-2 text-sm text-indigo-700">
<li>âœ“ OSI 7å±¤ã§ã®ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ—ãƒ­ã‚»ã‚¹</li>
<li>âœ“ å„å±¤ã§ã®ãƒ‡ãƒ¼ã‚¿å‘¼ã³åï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ã€ãƒ‘ã‚±ãƒƒãƒˆã€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰</li>
<li>âœ“ WebSocketã‚»ãƒƒã‚·ãƒ§ãƒ³å±¤å‹•ä½œã®æŠ€è¡“çš„æ„å‘³</li>
<li>âœ“ é€ä¿¡å´ãƒ»å—ä¿¡å´ã§ã®å±¤é–“é€£æºãƒ¡ã‚«ãƒ‹ã‚ºãƒ </li>
<li>âœ“ TLSæš—å·åŒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã®çµ±åˆãƒ‘ã‚¿ãƒ¼ãƒ³</li>
</ul>
</div>

<div>
<h4 class="font-semibold text-indigo-800 mb-3">ğŸ› ï¸ å®Ÿè·µçš„å¿œç”¨èƒ½åŠ›</h4>
<ul class="space-y-2 text-sm text-indigo-700">
<li>âœ“ å±¤åˆ¥ãƒ‡ãƒãƒƒã‚°ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®å®Ÿè·µ</li>
<li>âœ“ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å•é¡Œã®ä½“ç³»çš„åˆ†æ</li>
<li>âœ“ å„å±¤ã§ã®æœ€é©åŒ–æˆ¦ç•¥ã®é¸æŠ</li>
<li>âœ“ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å•é¡Œã®æ ¹æœ¬åŸå› ç‰¹å®š</li>
<li>âœ“ çµ±åˆçš„ãªWebSocketã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ</li>
</ul>
</div>

</div>

#### æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã¸ã®æº–å‚™

ã“ã®OSIå±¤ãƒ¢ãƒ‡ãƒ«ã®ç†è§£ã¯ã€æ¬¡ã®ã€ŒHTTP/1.1ã‹ã‚‰HTTP/3ã¾ã§ã®WebSocketå¯¾å¿œã€ãƒ¬ãƒƒã‚¹ãƒ³ã§ä»¥ä¸‹ã®ç™ºå±•çš„ãƒˆãƒ”ãƒƒã‚¯ã®åŸºç¤ã¨ãªã‚Šã¾ã™ã€‚

- **HTTP/2ã§ã®å¤šé‡åŒ–**ï¼šLayer 5ã§ã®è¤‡æ•°ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- **HTTP/3ã®QUIC**ï¼šLayer 4ã§ã®UDPæ´»ç”¨ã¨WebSocketå½±éŸ¿
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³é–“äº’æ›æ€§**ï¼šå„å±¤ã§ã®å¾Œæ–¹äº’æ›æ€§ç¢ºä¿æˆ¦ç•¥

</Card>

</Section>

</LessonLayout>