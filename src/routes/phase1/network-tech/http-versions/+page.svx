---
title: "HTTP/1.1ã‹ã‚‰HTTP/3ã¾ã§ã®WebSocketå¯¾å¿œ"
description: "å„HTTPãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã®WebSocketå‹•ä½œã®é•ã„ã¨å°†æ¥ã®æŠ€è¡“é¸æŠã«ã¤ã„ã¦å­¦ç¿’ã—ã¾ã™"
duration: 40
difficulty: "intermediate"
phase: 1
lesson: "2.3"
---

<script>
	import LessonIntro from '$lib/components/learning/LessonIntro.svelte';
	import ProtocolVersionDemo from '$lib/components/learning/ProtocolVersionDemo.svelte';
	import NextLesson from '$lib/components/learning/NextLesson.svelte';
	import ConceptDiagram from '$lib/components/learning/ConceptDiagram.svelte';
	import ProgressTracker from '$lib/components/learning/ProgressTracker.svelte';
	import CompletionMark from '$lib/components/learning/CompletionMark.svelte';
	import Mermaid from '$lib/components/Mermaid.svelte';
</script>

<LessonIntro 
	lessonId="phase1-network-tech-http-versions"
	title="HTTP/1.1ã‹ã‚‰HTTP/3ã¾ã§ã®WebSocketå¯¾å¿œ"
	duration="40åˆ†"
	difficulty="intermediate"
	prerequisites={['HTTPåŸºç¤ã®ç†è§£', 'WebSocketåŸºæœ¬çŸ¥è­˜', 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®æ¦‚å¿µ']}
/>

<div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
<div class="prose max-w-none p-8">

<details>
<summary><h2>ğŸ¯ å­¦ç¿’ç›®æ¨™</h2></summary>

ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ã€HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®é€²åŒ–ã¨WebSocketå¯¾å¿œã®å¤‰é·ã‚’ç†è§£ã—ã¾ã™ã€‚

- **HTTP/1.1ã§ã®WebSocketæ¨™æº–å®Ÿè£…**ã‚’ç†è§£
- **HTTP/2ã§ã®WebSocketåˆ¶é™ã¨å›é¿ç­–**ã‚’å­¦ç¿’
- **HTTP/3ã¨WebTransportã®é–¢ä¿‚**ã‚’æŠŠæ¡
- **å„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã®å®Ÿè£…é¸æŠ**ã®åˆ¤æ–­åŸºæº–ã‚’ç¿’å¾—

</details>

## ğŸ“ˆ HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®é€²åŒ–ã¨WebSocket

WebSocketï¼ˆ2011å¹´æ¨™æº–åŒ–ï¼‰ã¯**HTTP/1.1æ™‚ä»£**ã«è¨­è¨ˆã•ã‚ŒãŸãŸã‚ã€å¾Œã®HTTPãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯äº’æ›æ€§ã®èª²é¡ŒãŒã‚ã‚Šã¾ã™ã€‚

</div>
</div>

<div class="my-8">
  <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
    <h4 class="text-lg font-semibold text-gray-900 mb-4 text-center">HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®é€²åŒ–</h4>
    <Mermaid chart={`
timeline
    title HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨WebSocketã®æ­´å²
    
    1996 : HTTP/1.0
         : åŸºæœ¬çš„ãªWebé€šä¿¡
    
    1997 : HTTP/1.1
         : Keep-Alive
         : ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
    
    2011 : WebSocket RFC 6455
         : HTTP/1.1ãƒ™ãƒ¼ã‚¹ã§æ¨™æº–åŒ–
    
    2015 : HTTP/2
         : ãƒã‚¤ãƒŠãƒªãƒ•ãƒ¬ãƒ¼ãƒŸãƒ³ã‚°
         : å¤šé‡åŒ–
    
    2022 : HTTP/3
         : QUICä¸Šã§å‹•ä½œ
         : UDPåˆ©ç”¨
    `} />
  </div>
</div>

<div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
<div class="prose max-w-none p-8">

## 1. HTTP/1.1ã§ã®WebSocketï¼ˆæ¨™æº–å®Ÿè£…ï¼‰

### âœ… WebSocketã®åŸç‚¹ã¨ç¾åœ¨ã®ä¸»æµ

**HTTP/1.1ï¼ˆRFC 2616, 1999å¹´ï¼‰**ã¯ã€WebSocketã®è¨­è¨ˆåŸºç›¤ã¨ãªã£ãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ã€‚

```http
GET /chat HTTP/1.1
Host: example.com
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==
Sec-WebSocket-Version: 13
```

```http
HTTP/1.1 101 Switching Protocols
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=
```

### ğŸ”‘ HTTP/1.1ã®ç‰¹å¾´ã¨WebSocket

1. **Connection: Upgradeæ©Ÿæ§‹**
   - æ—¢å­˜ã®TCPæ¥ç¶šã‚’WebSocketã«åˆ‡ã‚Šæ›¿ãˆ
   - HTTPã‹ã‚‰WebSocketã¸ã®ã‚¹ãƒ ãƒ¼ã‚ºãªç§»è¡Œ

2. **Keep-Aliveæ¥ç¶šã®æ´»ç”¨**
   - æŒç¶šçš„TCPæ¥ç¶šã®å†åˆ©ç”¨
   - WebSocketã®æ°¸ç¶šæ¥ç¶šã¨è¦ªå’Œæ€§ãŒé«˜ã„

3. **ãƒ—ãƒ­ã‚­ã‚·ã¨ã®äº’æ›æ€§**
   - HTTP/1.1æº–æ‹ ã®ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒãƒ¼ã§ã®é€éæ€§
   - æ—¢å­˜ã‚¤ãƒ³ãƒ•ãƒ©ã®æ´»ç”¨ãŒå¯èƒ½

### ğŸ’¡ ç¾åœ¨ã®å®Ÿè£…ä¾‹

```javascript
// æ¨™æº–çš„ãªWebSocketå®Ÿè£…ï¼ˆHTTP/1.1ãƒ™ãƒ¼ã‚¹ï¼‰
const socket = new WebSocket('wss://api.example.com/realtime');

socket.onopen = (event) => {
    console.log('WebSocket connection established via HTTP/1.1');
};

// ãƒ•ãƒ¬ãƒ¼ãƒ é€ä¿¡ï¼ˆHTTP/1.1 TCPã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ä¸Šï¼‰
socket.send(JSON.stringify({
    type: 'message',
    data: 'Hello from HTTP/1.1 WebSocket!'
}));
```

---

## 2. HTTP/2ç’°å¢ƒã§ã®å‹•ä½œï¼ˆé™å®šçš„å¯¾å¿œï¼‰

### âš ï¸ HTTP/2ã®èª²é¡Œã¨WebSocket

**HTTP/2ï¼ˆRFC 7540, 2015å¹´ï¼‰**ã¯å¤šé‡åŒ–ã‚’å®Ÿç¾ã—ã¾ã—ãŸãŒã€WebSocketã¨ã®çµ±åˆã«ã¯èª²é¡ŒãŒã‚ã‚Šã¾ã™ã€‚

#### ğŸš« åˆæœŸã®HTTP/2ã§ã¯WebSocketéå¯¾å¿œ

HTTP/2ã®è¨­è¨ˆæ€æƒ³ã¯WebSocketã¨å¯¾ç«‹ã™ã‚‹éƒ¨åˆ†ãŒã‚ã‚Šã¾ã—ãŸã€‚

```
HTTP/2ã®è¨­è¨ˆæ€æƒ³:
- ã‚¹ãƒˆãƒªãƒ¼ãƒ å¤šé‡åŒ–ã«ã‚ˆã‚‹åŠ¹ç‡åŒ–
- ã‚µãƒ¼ãƒãƒ¼ãƒ—ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚¢ã‚¯ãƒ†ã‚£ãƒ–é…ä¿¡
- ãƒ˜ãƒƒãƒ€ãƒ¼åœ§ç¸®ã«ã‚ˆã‚‹é«˜é€ŸåŒ–

WebSocketã®ç‰¹å¾´:
- å˜ä¸€ã®æ°¸ç¶šæ¥ç¶š
- ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ™ãƒ¼ã‚¹ã®ç‹¬è‡ªãƒ—ãƒ­ãƒˆã‚³ãƒ«
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæ–¹å‘é€šä¿¡
```

#### ğŸ†• RFC 8441ã«ã‚ˆã‚‹æ‹¡å¼µï¼ˆ2018å¹´ï¼‰

**WebSocket over HTTP/2**ãŒæ¨™æº–åŒ–ã•ã‚Œã¾ã—ãŸã€‚

```http
:method = CONNECT
:protocol = websocket
:scheme = https
:path = /chat
:authority = server.example.com
```

### ğŸ“Š HTTP/2ã§ã®WebSocketå®Ÿè£…çŠ¶æ³

| ãƒ–ãƒ©ã‚¦ã‚¶/ã‚µãƒ¼ãƒãƒ¼ | WebSocket over HTTP/2 ã‚µãƒãƒ¼ãƒˆ |
|------------------|-------------------------------|
| Chrome | Experimental (è¦ãƒ•ãƒ©ã‚°) |
| Firefox | æœªå®Ÿè£… |
| Safari | æœªå®Ÿè£… |
| Node.js | é™å®šçš„ã‚µãƒãƒ¼ãƒˆ |
| nginx | ãƒ—ãƒ­ã‚­ã‚·ãƒ¢ãƒ¼ãƒ‰ã®ã¿ |

### ğŸ”„ ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥

å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€HTTP/2ç’°å¢ƒã§ã‚‚HTTP/1.1ã¸ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒä¸€èˆ¬çš„ã€‚

```javascript
// å®Ÿéš›ã®WebSocketå®Ÿè£…ï¼ˆè‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
const socket = new WebSocket('wss://api.example.com/realtime');
// ãƒ–ãƒ©ã‚¦ã‚¶ãŒè‡ªå‹•çš„ã«HTTP/1.1ã§WebSocketæ¥ç¶šã‚’ç¢ºç«‹
```

---

## 3. HTTP/3ï¼ˆQUICï¼‰æ™‚ä»£ã®å±•æœ›

### ğŸš€ HTTP/3ã¨WebSocketã®äº’æ›æ€§å•é¡Œ

**HTTP/3ï¼ˆRFC 9114, 2022å¹´ï¼‰**ã¯QUITãƒ™ãƒ¼ã‚¹ã§æ ¹æœ¬çš„ã«ç•°ãªã‚‹è¨­è¨ˆã€‚

#### âŒ WebSocketã®éäº’æ›æ€§

```
HTTP/3 (QUIC)ã®ç‰¹å¾´:
- UDP ãƒ™ãƒ¼ã‚¹ã®ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ
- ç‹¬è‡ªã®å¤šé‡åŒ–ã¨ãƒ•ãƒ­ãƒ¼åˆ¶å¾¡
- çµ„ã¿è¾¼ã¿ã®æ¥ç¶šç§»è¡Œæ©Ÿèƒ½

WebSocketã®å‰æ:
- TCP ãƒ™ãƒ¼ã‚¹ã®ä¿¡é ¼æ€§
- HTTPã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ©Ÿæ§‹
- æ—¢å­˜ãƒ—ãƒ­ã‚­ã‚·ã¨ã®äº’æ›æ€§
```

#### ğŸ†• WebTransportã«ã‚ˆã‚‹ä»£æ›¿

**WebTransport**ãŒHTTP/3æ™‚ä»£ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡æŠ€è¡“ã¨ã—ã¦ç™»å ´ã€‚

```javascript
// WebTransportï¼ˆHTTP/3ä¸Šã®åŒæ–¹å‘é€šä¿¡ï¼‰
const transport = new WebTransport('https://example.com/webtransport');

await transport.ready;

// åŒæ–¹å‘ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ä½œæˆ
const stream = await transport.createBidirectionalStream();
const writer = stream.writable.getWriter();
const reader = stream.readable.getReader();

// ãƒ‡ãƒ¼ã‚¿é€ä¿¡
await writer.write(new TextEncoder().encode('Hello WebTransport!'));

// ãƒ‡ãƒ¼ã‚¿å—ä¿¡
const { value } = await reader.read();
console.log(new TextDecoder().decode(value));
```

### ğŸ”® å°†æ¥ã®æŠ€è¡“é¸æŠ

| ç”¨é€” | HTTP/1.1 | HTTP/2 | HTTP/3 |
|------|----------|--------|--------|
| **WebSocket** | âœ… æ¨™æº–å®Ÿè£… | âš ï¸ é™å®šçš„ | âŒ éå¯¾å¿œ |
| **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡** | WebSocket | WebSocket + ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ | WebTransport |
| **æ¨å¥¨æŠ€è¡“** | WebSocket | WebSocketï¼ˆH1.1ï¼‰ | WebTransport |

---

## ğŸš€ å®Ÿè·µãƒ‡ãƒ¢

### ä½“é¨“ã—ã¦ã¿ã‚ˆã†

å„HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã®WebSocketå¯¾å¿œçŠ¶æ³ã‚’å®Ÿéš›ã«ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

<ProtocolVersionDemo />

### ãƒ‡ãƒ¢ã§ç¢ºèªã§ãã‚‹ã“ã¨

1. **WebSocketæ¥ç¶šãƒ†ã‚¹ãƒˆ**: å®Ÿéš›ã®WebSocketæ¥ç¶šæ€§èƒ½ã‚’æ¸¬å®š
2. **HTTP/2æ¤œå‡º**: ç¾åœ¨ã®æ¥ç¶šã§HTTP/2ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèª
3. **WebTransportã‚µãƒãƒ¼ãƒˆ**: ãƒ–ãƒ©ã‚¦ã‚¶ã®WebTransportå¯¾å¿œçŠ¶æ³ã‚’ç¢ºèª

### å®Ÿè¡Œæ‰‹é †

1. **ãƒ—ãƒ­ãƒˆã‚³ãƒ«æ¤œå‡º**ï¼šã€ŒProtocol Detectionã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç¾åœ¨ã®HTTPãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèª
2. **WebSocketæ¥ç¶šãƒ†ã‚¹ãƒˆ**ï¼šã€ŒWebSocket Testã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ¥ç¶šæ€§èƒ½ã‚’æ¸¬å®š
3. **WebTransportç¢ºèª**ï¼šã€ŒWebTransport Checkã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å¯¾å¿œçŠ¶æ³ã‚’ç¢ºèª
4. **çµæœåˆ†æ**ï¼šå„ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®ç‰¹å¾´ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ¯”è¼ƒ
5. **äº’æ›æ€§ç¢ºèª**ï¼šãƒ–ãƒ©ã‚¦ã‚¶ã¨ã‚µãƒ¼ãƒãƒ¼ã®å¯¾å¿œçŠ¶æ³ã‚’æŠŠæ¡

---

## 5. å®Ÿè£…ã«ãŠã‘ã‚‹é¸æŠæŒ‡é‡

### ğŸ¯ ç¾åœ¨ï¼ˆ2024å¹´ï¼‰ã®æ¨å¥¨å®Ÿè£…

#### âœ… ä¸»æµãªé¸æŠ

```javascript
// 1. WebSocketï¼ˆHTTP/1.1ãƒ™ãƒ¼ã‚¹ï¼‰- æœ€ã‚‚å®‰å®š
const socket = new WebSocket('wss://api.example.com/ws');

// 2. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æˆ¦ç•¥ã®å®Ÿè£…
class RobustWebSocket {
    constructor(url) {
        this.url = url;
        this.connect();
    }
    
    connect() {
        try {
            this.socket = new WebSocket(this.url);
            this.socket.onopen = () => console.log('Connected via WebSocket');
        } catch (error) {
            console.log('WebSocket failed, considering alternatives...');
            this.fallbackToHTTP2();
        }
    }
    
    fallbackToHTTP2() {
        // Server-Sent Events + fetch() ã«ã‚ˆã‚‹ç–‘ä¼¼åŒæ–¹å‘é€šä¿¡
        this.eventSource = new EventSource(this.url.replace('ws', 'http') + '/events');
    }
}
```

#### ğŸ”¬ å®Ÿé¨“çš„ãªé¸æŠï¼ˆChromeç­‰ï¼‰

```javascript
// WebTransportï¼ˆå®Ÿé¨“çš„ï¼‰
if ('WebTransport' in window) {
    const transport = new WebTransport('https://api.example.com/webtransport');
    // ã‚ˆã‚Šé«˜æ€§èƒ½ãªãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡
} else {
    // WebSocketãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
    const socket = new WebSocket('wss://api.example.com/ws');
}
```

### ğŸ“‹ é¸æŠåŸºæº–

1. **äº’æ›æ€§é‡è¦–**: WebSocketï¼ˆHTTP/1.1ï¼‰
2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹é‡è¦–**: WebTransportï¼ˆå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶é™å®šï¼‰
3. **ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³**: WebSocket + é©åˆ‡ãªãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯

---

## 6. ã¾ã¨ã‚ã¨å°†æ¥å±•æœ›

### ğŸ”‘ é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

1. **HTTP/1.1ã§ã®å®‰å®šæ€§**
   - ç¾åœ¨ã‚‚WebSocketã®ä¸»è¦åŸºç›¤
   - å¹…åºƒã„ãƒ–ãƒ©ã‚¦ã‚¶ãƒ»ã‚µãƒ¼ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ

2. **HTTP/2ã§ã®èª²é¡Œ**
   - é™å®šçš„ãªWebSocketå¯¾å¿œ
   - å®Ÿè£…ã®è¤‡é›‘ã•ã¨ã‚µãƒãƒ¼ãƒˆã®ä¸ååˆ†ã•

3. **HTTP/3ã§ã®è»¢æ›ç‚¹**
   - WebSocketã®éäº’æ›æ€§
   - WebTransportã¸ã®ç§»è¡Œã®å¿…è¦æ€§

### ğŸ“ å­¦ç¿’ã®ç¢ºèª

- [ ] HTTP/1.1ã§ã®WebSocketæ¨™æº–å®Ÿè£…ã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] HTTP/2ã§ã®WebSocketåˆ¶é™äº‹é …ã‚’æŠŠæ¡ã—ã¦ã„ã‚‹
- [ ] HTTP/3æ™‚ä»£ã®WebTransportä»£æ›¿æŠ€è¡“ã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] å®Ÿè£…ã«ãŠã‘ã‚‹æŠ€è¡“é¸æŠåŸºæº–ã‚’åˆ¤æ–­ã§ãã‚‹

### ğŸ”® ä»Šå¾Œã®å±•æœ›

- **çŸ­æœŸï¼ˆ1-2å¹´ï¼‰**: WebSocketï¼ˆHTTP/1.1ï¼‰ãŒä¸»æµç¶™ç¶š
- **ä¸­æœŸï¼ˆ3-5å¹´ï¼‰**: WebTransportã®æ™®åŠé–‹å§‹
- **é•·æœŸï¼ˆ5å¹´ä»¥ä¸Šï¼‰**: WebTransportãŒä¸»æµã«ãªã‚‹å¯èƒ½æ€§

</div>
</div>

<ProgressTracker 
	lessonId="phase1-network-tech-http-versions"
	sectionTitle="ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æŠ€è¡“åŸºç¤"
/>

<CompletionMark lessonId="phase1-network-tech-http-versions" />

<NextLesson 
	nextLessonId="2.4"
	nextLessonTitle="TCPã¨WebSocketã®é–¢ä¿‚ç†è§£" 
	nextLessonPath="/phase1/network-tech/tcp-websocket"
/>

<div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden mt-8">
<div class="prose max-w-none p-8">

## ğŸ”— é–¢é€£ãƒªã‚½ãƒ¼ã‚¹

- [RFC 6455 - The WebSocket Protocol](https://tools.ietf.org/html/rfc6455)
- [RFC 8441 - Bootstrapping WebSockets with HTTP/2](https://tools.ietf.org/html/rfc8441)
- [WebTransport Explainer](https://github.com/w3c/webtransport/blob/main/explainer.md)
- [HTTP/3 explained](https://http3-explained.haxx.se/)
- [Can I use WebTransport](https://caniuse.com/webtransport)
- [Chrome WebTransport Documentation](https://developer.chrome.com/articles/webtransport/)

</div>
</div>